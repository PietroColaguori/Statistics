<!DOCTYPE html>
<html>
<head>
    <meta http-equiv='cache-control' content='no-cache'> 
    <meta http-equiv='expires' content='0'> 
    <meta http-equiv='pragma' content='no-cache'>
    <title>Homework 2</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="../prism.css"> 
</head>
<body>
    <!-- For this HW we are going to need AJAX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>

    <h1>Homework 2</h1>
    <h2>Author: Pietro Colaguori 1936709</h2>
    <a href="../index.html">Home</a>
    <hr>
    <p>The request is as follows:</p><br>
    <pre class="question">Choose 3 variables from our surveys:
        - one Qualitative
        - one Quantitative discrete
        - one Quantitative continuous (use class intervals in this case, obviously)
        
        create the most efficient algorithms to compute the frequency (absolute/relative/percentage) distribution of:
        
        - the 3 variables
        - the joint distribution of 2 variables (use a general logic, where variables could be any number).
        
        Double check/compare the results using some DBMS functionalities you prefer (eg., access, oracle online, postgres, ...)</pre>

    <h3 class="red">Professional Life Survey - Analysis</h3>
    <!-- Qualitative: expected work sector, Quantitative: expected salary, Quantitative Continuous: height-->
    <p> Upload an XLSX file </p>
    <input type="file" id="fileInput" accept=".xlsx">
    <button id="upload" onclick="return analyze()">Upload</button>
    <div id="output"></div>
    
    <div id="results">
        <!-- Frequency distributions will be displayed here -->
    </div>

    <script>
        function analyze() {
            // Access contents of XLSX file
            var file = document.getElementById("fileInput").files[0];
            var reader = new FileReader();
            reader.onload = function(e) {
                var data = e.target.result;
                var workbook = XLSX.read(data, {type: 'binary'});
                var sheet_name_list = workbook.SheetNames;
                var xlData = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]], {blankrows: false});
                
                // Access the values of the column "expected work sectors"
                var workSectors = [];
                for (var i = 0; i < xlData.length; i++) {
                    if (xlData[i]["Expected work sectors"] !== undefined) {
                        workSectors.push(xlData[i]["Expected work sectors"]);
                    }
                }
        
                // Access the values of the column "expected salary"
                var expectedSalary = [];
                for (var i = 0; i < xlData.length; i++) {
                    if (xlData[i]["Expected net remuneration (monthly)"] !== undefined) {
                        expectedSalary.push(xlData[i]["Expected net remuneration (monthly)"]);
                    }
                }
        
                // Access the values of the column "height"
                var height = [];
                for (var i = 0; i < xlData.length; i++) {
                    if (xlData[i]["height"] !== undefined) {
                        height.push(xlData[i]["height"]);
                    }
                }
        
                // Compute the frequency distribution of the 3 variables
                var workSectorsFreq = {};
                for (var i = 0; i < workSectors.length; i++) {
                    if (workSectorsFreq[workSectors[i]] == undefined) {
                        workSectorsFreq[workSectors[i]] = 1;
                    } else {
                        workSectorsFreq[workSectors[i]]++;
                    }
                }
        
                var expectedSalaryFreq = {};
                for (var i = 0; i < expectedSalary.length; i++) {
                    if (expectedSalaryFreq[expectedSalary[i]] == undefined) {
                        expectedSalaryFreq[expectedSalary[i]] = 1;
                    } else {
                        expectedSalaryFreq[expectedSalary[i]]++;
                    }
                }
        
                var heightFreq = {};
                for (var i = 0; i < height.length; i++) {
                    if (heightFreq[height[i]] == undefined) {
                        heightFreq[height[i]] = 1;
                    } else {
                        heightFreq[height[i]]++;
                    }
                }
        
                // Compute the relative and percentage frequencies of the 3 variables
                var workSectorsRelFreq = {};
                var workSectorsPercFreq = {};
                for (var sector in workSectorsFreq) {
                    workSectorsRelFreq[sector] = workSectorsFreq[sector] / workSectors.length;
                    workSectorsPercFreq[sector] = workSectorsRelFreq[sector] * 100;
                }
        
                var expectedSalaryRelFreq = {};
                var expectedSalaryPercFreq = {};
                for (var salary in expectedSalaryFreq) {
                    expectedSalaryRelFreq[salary] = expectedSalaryFreq[salary] / expectedSalary.length;
                    expectedSalaryPercFreq[salary] = expectedSalaryRelFreq[salary] * 100;
                }
        
                var heightRelFreq = {};
                var heightPercFreq = {};
                for (var h in heightFreq) {
                    heightRelFreq[h] = heightFreq[h] / height.length;
                    heightPercFreq[h] = heightRelFreq[h] * 100;
                }
        
                // Display the frequency distributions on the page
                displayResults(workSectorsFreq, workSectorsRelFreq, workSectorsPercFreq, expectedSalaryFreq, expectedSalaryRelFreq, expectedSalaryPercFreq, heightFreq, heightRelFreq, heightPercFreq);
            };
            reader.readAsBinaryString(file);
        }
        
        function displayResults(workSectorsFreq, workSectorsRelFreq, workSectorsPercFreq, expectedSalaryFreq, expectedSalaryRelFreq, expectedSalaryPercFreq, heightFreq, heightRelFreq, heightPercFreq) {
            var resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = "<h3>Frequency Distributions:</h3>";
            
            // Display the frequency distribution for the "Expected work sectors" variable
            resultsDiv.innerHTML += "<h4>Expected Work Sectors:</h4>";
            for (var sector in workSectorsFreq) {
                resultsDiv.innerHTML += sector + ": " + workSectorsFreq[sector] + " (" + workSectorsRelFreq[sector].toFixed(2) + " or " + workSectorsPercFreq[sector].toFixed(2) + "%)" + "<br>";
            }
        
            // Display the frequency distribution for the "Expected salary" variable
            resultsDiv.innerHTML += "<h4>Expected Salary:</h4>";
            for (var salary in expectedSalaryFreq) {
                resultsDiv.innerHTML += salary + ": " + expectedSalaryFreq[salary] + " (" + expectedSalaryRelFreq[salary].toFixed(2) + " or " + expectedSalaryPercFreq[salary].toFixed(2) + "%)" + "<br>";
            }
        
            // Display the frequency distribution for the "Height" variable
            resultsDiv.innerHTML += "<h4>Height:</h4>";
            for (var h in heightFreq) {
                resultsDiv.innerHTML += h + ": " + heightFreq[h] + " (" + heightRelFreq[h].toFixed(2) + " or " + heightPercFreq[h].toFixed(2) + "%)" + "<br>";
            }
        }
    </script>

    <h3 class="red">Afterlife Survey - Analysis</h3>
    <!-- Qualitative: religion, Quantitative: ???, Quantitative Continuous: ???-->
    <p> Upload an XLSX file </p>
    <input type="file" id="fileInput2" accept=".xlsx">
    <button id="upload2" onclick="return analyze2()">Upload</button>
    <div id="output2"></div>
    
    <div id="results2">
        <!-- Frequency distributions will be displayed here -->
    </div>

    <script>
        function analyze2() {
            // Access contents of XLSX file
            var file = document.getElementById("fileInput2").files[0];
            var reader = new FileReader();
            reader.onload = function(e) {
                var data = e.target.result;
                var workbook = XLSX.read(data, {type: 'binary'});
                var sheet_name_list = workbook.SheetNames;
                var xlData = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]], {blankrows: false});
                
                // Access the values of the column "Religious yes/no"
                var religious = [];
                for (var i = 0; i < xlData.length; i++) {
                    if (xlData[i]["Religious yes/no"] !== undefined) {
                        religious.push(xlData[i]["Religious yes/no"].toLowerCase());
                    }
                }
        
                // Compute the frequency distribution of the 3 variables
                var religious = {};
                for (var i = 0; i < religious.length; i++) {
                    if (religiousFreq[religious[i]] == undefined) {
                        religiousFreq[religious[i]] = 1;
                    } else {
                        workSectorsFreq[religious[i]]++;
                    }
                }
        
                // Compute the relative and percentage frequencies of the 3 variables
                var religousRelFreq = {};
                var religiousPercFreq = {};
                for (var relogiousAnsw in religiousFreq) {
                    religiousRelFreq[relogiousAnsw] = religiousFreq[relogiousAnsw] / religious.length;
                    religiousPercFreq[relogiousAnsw] = religousRelFreq[relogiousAnsw] * 100;
                }
        
                // Display the frequency distributions on the page
                displayResults2(religiousFreq, religousRelFreq, religiousPercFreq);
            };
            reader.readAsBinaryString(file);
        }
        
        function displayResults2(religiousFreq, religousRelFreq, religiousPercFreq) {
            var resultsDiv = document.getElementById("results2");
            resultsDiv.innerHTML = "<h3>Frequency Distributions:</h3>";
            
            // Display the frequency distribution for the "Expected work sectors" variable
            resultsDiv.innerHTML += "<h4>Religious [yes/no]:</h4>";
            for (var relogiousAnsw in religiousFreq) {
                resultsDiv.innerHTML += relogiousAnsw + ": " + religiousFreq[relogiousAnsw] + " (" + religousRelFreq[relogiousAnsw].toFixed(2) + " or " + religiousPercFreq[relogiousAnsw].toFixed(2) + "%)" + "<br>";
            }
        }
    </script>

    <script src="../prism.js"></script>
</body>
</html>
